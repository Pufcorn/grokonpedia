<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Grokonpedia – Lecture</title>
<style>
body { background:#333; color:#fff; font-family:sans-serif; margin:20px; line-height:1.5; }
#content { max-width:800px; margin:auto; padding:20px; background:#444; border-radius:10px; white-space: pre-wrap; }
h1 { text-align:center; margin-bottom:20px; font-size:2em; }
.word { font-weight:bold; margin-top:15px; }
.definition { margin-left:10px; margin-bottom:15px; }
</style>
</head>
<body>

<div id="content">Chargement…</div>

<script>
const params = new URLSearchParams(window.location.search);
const file = params.get('f');
if(!file){ document.getElementById('content').innerText="Erreur : aucune lettre reçue."; }

fetch(`${file}.md`)
.then(r=>r.text())
.then(txt=>{
    const lines = txt.split(/\n+/).map(l=>l.trimEnd()).filter(l=>l);

    if(lines.length===0){ document.getElementById('content').innerText="Fichier vide."; return; }

    const letter = lines.shift();
    let html = `<h1>${letter}</h1>`;
    let currentWord = null;

    lines.forEach(line=>{
        if (/^(v\.|n\.|adj\.|Expr\.|EX|—)/.test(line)) {
            html += `<div class="definition">${line}</div>`;
        } else {
            html += `<div class="word">${line}</div>`;
        }
    });

    document.getElementById('content').innerHTML = html;
})
.catch(err=>{ document.getElementById('content').innerText="Erreur de chargement."; });
</script>

</body>
</html>
